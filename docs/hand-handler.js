window.addEventListener("DOMContentLoaded",()=>{c(),i()});const o=document.getElementById("dropzone"),r=document.getElementById("hand");o.addEventListener("dragover",e=>{e.preventDefault(),o.style.background="#ccf"});o.addEventListener("dragleave",()=>{o.style.background="transparent"});o.addEventListener("drop",async e=>{e.preventDefault(),o.style.background="transparent";for(const t of e.dataTransfer.files){if(!t.type.startsWith("image/"))continue;const d=URL.createObjectURL(t),n=document.createElement("img");n.src=d,n.classList.add("card"),r.appendChild(n)}c(),i()});document.addEventListener("click",e=>{const t=!!document.body.querySelector(".preview"),d=e.target.closest(".card");if(!t&&d){d.classList.add("hidden"),document.body.classList.add("preview-open");const n=document.createElement("div");n.classList.add("preview");const s=d.cloneNode(!0);s.style.setProperty("--angle","0deg"),s.style.marginLeft="0",s.classList.remove("hidden"),n.appendChild(s),document.body.appendChild(n)}else if(t){const n=document.body.querySelector(".preview");n&&n.remove();const s=r.querySelector(".card.hidden");s&&s.classList.remove("hidden"),document.body.classList.remove("preview-open")}});function c(){const e=Array.from(document.querySelectorAll("#hand .card")),t=e.length;if(!t)return;const d=30,n=-d/2,s=d/(t-1||1);e.forEach((l,g)=>{const v=n+s*g;l.style.setProperty("--angle",`${v}deg`),l.style.zIndex=g+1})}r.addEventListener("dragover",e=>{e.preventDefault(),e.target===r&&a&&(r.classList.add("drag-over-left"),e.dataTransfer.dropEffect="move")});r.addEventListener("dragleave",e=>{e.target===r&&r.classList.remove("drag-over-left")});r.addEventListener("drop",e=>{e.preventDefault(),r.classList.remove("drag-over-left"),e.target===r&&a&&(r.insertBefore(a,r.firstChild),c(),i())});let a=null;function i(){r.querySelectorAll(".card").forEach(t=>{t.setAttribute("draggable",!0),t.addEventListener("dragstart",f),t.addEventListener("dragover",u),t.addEventListener("dragleave",p),t.addEventListener("drop",L),t.addEventListener("dragend",m)})}function f(e){a=e.currentTarget,a.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain","")}function u(e){e.preventDefault();const t=e.currentTarget;t!==a&&(t.classList.add("drag-over"),e.dataTransfer.dropEffect="move")}function p(e){e.currentTarget.classList.remove("drag-over")}function L(e){e.preventDefault();const t=e.currentTarget;if(t.classList.remove("drag-over"),a&&t!==a){const d=t.nextSibling;r.insertBefore(a,d),c(),i()}}function m(e){a&&(a.classList.remove("dragging"),a=null),r.querySelectorAll(".drag-over").forEach(t=>t.classList.remove("drag-over"))}
